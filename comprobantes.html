<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Emitir Comprobante MÃ©dico</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Oculta botones durante la impresiÃ³n -->
  <style>
    @media print {
      .no-imprimir {
        display: none;
      }
    }
  </style>
</head>
<body class="bg-light">

  <!-- Contenedor general del formulario -->
  <div class="container mt-5">
    <div class="card shadow-sm">
      
      <!-- Encabezado del panel -->
      <div class="card-header bg-dark text-white text-center">
        <h4>Generar Comprobante MÃ©dico</h4>
      </div>

      <div class="card-body">
        <!-- Formulario que se autocompleta segÃºn el paciente -->
        <form id="formComprobante">
          
          <!-- Fila: selecciÃ³n de cÃ©dula y muestra de nombre -->
          <div class="row mb-3">
            <div class="col-md-6">
              <label for="cedula" class="form-label">Seleccionar paciente (CÃ©dula)</label>
              <select class="form-select" id="cedula" required>
                <option value="">Seleccione...</option>
                <option value="123456789">123456789 â€” Carlos Herrera</option>
                <option value="987654321">987654321 â€” MarÃ­a GonzÃ¡lez</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label">Nombre del Paciente</label>
              <p id="paciente" class="form-control-plaintext">â€”</p>
            </div>
          </div>

          <!-- Fila: servicio mÃ©dico y nombre del mÃ©dico -->
          <div class="row mb-3">
            <div class="col-md-6">
              <label for="servicio" class="form-label">Servicio MÃ©dico</label>
              <input type="text" class="form-control" id="servicio" readonly required>
            </div>
            <div class="col-md-6">
              <label for="medico" class="form-label">Profesional MÃ©dico</label>
              <input type="text" class="form-control" id="medico" readonly required>
            </div>
          </div>

          <!-- Fila: fecha, hora y monto -->
          <div class="row mb-3">
            <div class="col-md-4">
              <label for="fecha" class="form-label">Fecha</label>
              <input type="date" class="form-control" id="fecha" readonly required>
            </div>
            <div class="col-md-4">
              <label for="hora" class="form-label">Hora</label>
              <input type="time" class="form-control" id="hora" readonly required>
            </div>
            <div class="col-md-4">
              <label for="monto" class="form-label">Monto (â‚¡)</label>
              <input type="number" class="form-control" id="monto" readonly required>
            </div>
          </div>

          <!-- Botones: generar e imprimir comprobante -->
          <div class="d-grid gap-2 no-imprimir">
            <button type="submit" class="btn btn-success">Generar Comprobante</button>
            <button type="button" class="btn btn-outline-primary" onclick="window.print()">Imprimir Comprobante</button>
          </div>
        </form>

        <!-- AquÃ­ se mostrarÃ¡ el comprobante generado -->
        <div id="comprobanteGenerado" class="mt-4"></div>
      </div>

      <!-- BotÃ³n de regreso -->
      <div class="card-footer text-center no-imprimir">
        <a href="panel_administrador.html" class="btn btn-outline-secondary">Volver al Panel</a>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS (necesario para interacciones de UI) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <!-- SimulaciÃ³n de base de datos de citas mÃ©dicas -->
  <script>
    const citas = {
      "123456789": {
        paciente: "Carlos Herrera",
        servicio: "Consulta General",
        medico: "Dr. Luis GÃ³mez",
        fecha: "2024-07-23",
        hora: "09:00",
        monto: "5000"
      },
      "987654321": {
        paciente: "MarÃ­a GonzÃ¡lez",
        servicio: "EvaluaciÃ³n CardiolÃ³gica",
        medico: "Dra. Carla MÃ©ndez",
        fecha: "2024-07-24",
        hora: "11:30",
        monto: "8000"
      }
    };

    // Al cambiar la cÃ©dula, se autocompletan los campos
    document.getElementById("cedula").addEventListener("change", function () {
      const cedula = this.value;
      if (citas[cedula]) {
        const datos = citas[cedula];
        document.getElementById("paciente").textContent = datos.paciente;
        document.getElementById("servicio").value = datos.servicio;
        document.getElementById("medico").value = datos.medico;
        document.getElementById("fecha").value = datos.fecha;
        document.getElementById("hora").value = datos.hora;
        document.getElementById("monto").value = datos.monto;
      } else {
        // Si no existe el paciente, limpiar campos
        document.getElementById("paciente").textContent = "â€”";
        document.getElementById("servicio").value = "";
        document.getElementById("medico").value = "";
        document.getElementById("fecha").value = "";
        document.getElementById("hora").value = "";
        document.getElementById("monto").value = "";
      }
    });

    // Al presionar "Generar Comprobante" se crea el documento
    document.getElementById("formComprobante").addEventListener("submit", function(e) {
      e.preventDefault();

      const paciente = document.getElementById("paciente").textContent;
      const cedula = document.getElementById("cedula").value;
      const servicio = document.getElementById("servicio").value;
      const medico = document.getElementById("medico").value;
      const fecha = document.getElementById("fecha").value;
      const hora = document.getElementById("hora").value;
      const monto = document.getElementById("monto").value;

      // HTML para mostrar comprobante en pantalla
      const comprobante = `
        <div class="border p-3 bg-white">
          <h5 class="text-center">ðŸ“„ Comprobante MÃ©dico</h5>
          <p><strong>Paciente:</strong> ${paciente}</p>
          <p><strong>CÃ©dula:</strong> ${cedula}</p>
          <p><strong>Servicio:</strong> ${servicio}</p>
          <p><strong>Profesional:</strong> ${medico}</p>
          <p><strong>Fecha:</strong> ${fecha}</p>
          <p><strong>Hora:</strong> ${hora}</p>
          <p><strong>Monto:</strong> â‚¡${monto}</p>
          <hr>
          <p class="text-center">Gracias por utilizar nuestros servicios</p>
        </div>
      `;

      document.getElementById("comprobanteGenerado").innerHTML = comprobante;
    });
  </script>
</body>
</html>
